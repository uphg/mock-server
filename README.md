# Mock Server

ğŸš€ ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Mock API æœåŠ¡å™¨ï¼Œæ”¯æŒé…ç½®æ–‡ä»¶é©±åŠ¨ã€è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆã€çƒ­æ›´æ–°ç­‰ç‰¹æ€§ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ“ **é…ç½®é©±åŠ¨** - é€šè¿‡ JSON é…ç½®æ–‡ä»¶å®šä¹‰ API è·¯ç”±
- ğŸ”„ **çƒ­æ›´æ–°** - é…ç½®æ–‡ä»¶å˜æ›´æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½è·¯ç”±
- ğŸ“š **è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ** - æ ¹æ®é…ç½®è‡ªåŠ¨ç”Ÿæˆ Markdown API æ–‡æ¡£
- ğŸ¯ **è·¯ç”±é»˜è®¤é…ç½®** - æ”¯æŒä¸ºå¤šä¸ªè·¯ç”±å®šä¹‰é€šç”¨é…ç½®
- ğŸŒ **CORS æ”¯æŒ** - å¯é…ç½®çš„è·¨åŸŸèµ„æºå…±äº«
- â±ï¸ **å“åº”å»¶è¿Ÿ** - æ¨¡æ‹ŸçœŸå®ç½‘ç»œå»¶è¿Ÿ
- ğŸ“Š **å¥åº·æ£€æŸ¥** - å†…ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹
- ğŸ”§ **æ¨¡æ¿å˜é‡** - æ”¯æŒåŠ¨æ€å“åº”å†…å®¹
- ğŸ§ª **æµ‹è¯•å‹å¥½** - å®Œæ•´çš„æµ‹è¯•å¥—ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### å¯åŠ¨æœåŠ¡å™¨

```bash
# ç”Ÿäº§æ¨¡å¼
pnpm start

# å¼€å‘æ¨¡å¼ï¼ˆæ”¯æŒçƒ­æ›´æ–°ï¼‰
ppnpm dev

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
pnpm start custom.config.json
```

### è®¿é—®æœåŠ¡

å¯åŠ¨åï¼ŒæœåŠ¡å™¨ä¼šæ˜¾ç¤ºå®Œæ•´çš„è®¿é—®ä¿¡æ¯ï¼š

```
ğŸš€ MockæœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼
- æœåŠ¡å™¨åœ°å€: http://localhost:3001
- å®Œæ•´è·¯å¾„: http://localhost:3001/api
- å¥åº·æ£€æŸ¥: http://localhost:3001/health
- APIæ–‡æ¡£: http://localhost:3001/api/docs
- ç«¯å£: 3001
- é…ç½®æ–‡ä»¶: /path/to/mock.config.json
- åŸºç¡€è·¯å¾„: /api
- å…¨å±€å»¶è¿Ÿ: 0ms
- CORS: å¯ç”¨
- Mockç›®å½•: ./data
```

## ğŸ“‹ é…ç½®æ–‡ä»¶

### åŸºæœ¬é…ç½®

åˆ›å»º `mock.config.json` æ–‡ä»¶ï¼š

```json
{
  "port": 3001,
  "baseUrl": "/api",
  "delay": 0,
  "cors": true,
  "mockDir": "./data",
  "routes": [
    {
      "name": "è·å–ç”¨æˆ·åˆ—è¡¨",
      "path": "/users",
      "method": "GET",
      "responseFile": "users.json"
    }
  ]
}
```

### é…ç½®é€‰é¡¹

| é€‰é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `port` | number | 3000 | æœåŠ¡å™¨ç«¯å£ |
| `host` | string | localhost | æœåŠ¡å™¨ä¸»æœº |
| `baseUrl` | string | / | API åŸºç¡€è·¯å¾„ |
| `delay` | number | 0 | å…¨å±€å“åº”å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| `cors` | boolean | true | æ˜¯å¦å¯ç”¨ CORS |
| `mockDir` | string | ./data | Mock æ•°æ®æ–‡ä»¶ç›®å½• |
| `docsDir` | string | ./docs/api | API æ–‡æ¡£æ–‡ä»¶ç›®å½• |

## ğŸ›£ï¸ è·¯ç”±é…ç½®

### åŸºæœ¬è·¯ç”±

```json
{
  "routes": [
    {
      "name": "è·å–ç”¨æˆ·è¯¦æƒ…",
      "path": "/users/:id",
      "method": "GET",
      "response": {
        "id": "{{params.id}}",
        "name": "ç”¨æˆ·{{params.id}}",
        "email": "user{{params.id}}@example.com"
      }
    }
  ]
}
```

### è·¯ç”±é€‰é¡¹

| é€‰é¡¹ | ç±»å‹ | å¿…éœ€ | æè¿° |
|------|------|------|------|
| `name` | string | æ˜¯ | è·¯ç”±åç§° |
| `path` | string | æ˜¯ | è·¯ç”±è·¯å¾„ï¼ˆæ”¯æŒå‚æ•°ï¼‰ |
| `method` | string | æ˜¯ | HTTP æ–¹æ³• |
| `response` | object | å¦ | ç›´æ¥å“åº”æ•°æ® |
| `responseFile` | string | å¦ | å“åº”æ•°æ®æ–‡ä»¶è·¯å¾„ |
| `statusCode` | number | å¦ | HTTP çŠ¶æ€ç ï¼ˆé»˜è®¤ 200ï¼‰ |
| `headers` | object | å¦ | è‡ªå®šä¹‰å“åº”å¤´ |
| `delay` | number | å¦ | è·¯ç”±çº§åˆ«å»¶è¿Ÿ |

### æ¨¡æ¿å˜é‡

æ”¯æŒåœ¨å“åº”ä¸­ä½¿ç”¨æ¨¡æ¿å˜é‡ï¼š

- `{{params.id}}` - è·¯å¾„å‚æ•°
- `{{query.name}}` - æŸ¥è¯¢å‚æ•°
- `{{body.email}}` - è¯·æ±‚ä½“å‚æ•°
- `{{responseTime}}` - å“åº”æ—¶é—´

## ğŸ¯ è·¯ç”±é»˜è®¤é…ç½®

ä¸ºå¤šä¸ªè·¯ç”±å®šä¹‰é€šç”¨é…ç½®ï¼Œé¿å…é‡å¤ï¼š

```json
{
  "routeDefaults": [
    {
      "name": "api-headers",
      "description": "APIé€šç”¨å“åº”å¤´é…ç½®",
      "config": {
        "headers": {
          "Content-Type": "application/json",
          "X-API-Version": "v1"
        }
      },
      "includes": ["/users*", "/products*"],
      "excludes": ["/error"]
    }
  ]
}
```

### é…ç½®ä¼˜å…ˆçº§

1. **è·¯ç”±æ˜¾å¼é…ç½®** - æœ€é«˜ä¼˜å…ˆçº§
2. **è·¯ç”±é»˜è®¤é…ç½®** - ä¸­ç­‰ä¼˜å…ˆçº§
3. **å…¨å±€é»˜è®¤é…ç½®** - æœ€ä½ä¼˜å…ˆçº§

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [ROUTE_DEFAULTS.md](./ROUTE_DEFAULTS.md)

## ğŸ“š æ–‡æ¡£ç”Ÿæˆ

### è‡ªåŠ¨ç”Ÿæˆ

å¯åŠ¨æœåŠ¡å™¨æ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼š

```bash
pnpm start
```

### æ‰‹åŠ¨ç”Ÿæˆ

```bash
# ç”Ÿæˆæ–‡æ¡£
ppnpm docs:generate

# ç›‘å¬æ¨¡å¼
ppnpm docs:generate:watch
```

### æ–‡æ¡£é¢„è§ˆ

ä½¿ç”¨ VitePress é¢„è§ˆæ–‡æ¡£ï¼š

```bash
# å¼€å‘æ¨¡å¼
ppnpm docs:dev

# æ„å»ºæ–‡æ¡£
ppnpm docs:build

# é¢„è§ˆæ„å»ºç»“æœ
ppnpm docs:preview
```

ç”Ÿæˆçš„æ–‡æ¡£åŒ…å«ï¼š
- API æ€»è§ˆ
- æ¯ä¸ªæ¥å£çš„è¯¦ç»†æ–‡æ¡£
- å‚æ•°è¡¨æ ¼
- è¯·æ±‚/å“åº”ç¤ºä¾‹
- é”™è¯¯å“åº”è¯´æ˜

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [DOCS_GENERATION.md](./DOCS_GENERATION.md)

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# ç›‘å¬æ¨¡å¼
ppnpm test:watch
```

### æµ‹è¯•è¦†ç›–

é¡¹ç›®åŒ…å«å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼š

- å•å…ƒæµ‹è¯•
- é›†æˆæµ‹è¯•
- E2E æµ‹è¯•
- æ€§èƒ½æµ‹è¯•

## ğŸ“ é¡¹ç›®ç»“æ„

```
mock-server/
â”œâ”€â”€ src/                    # æºä»£ç 
â”‚   â”œâ”€â”€ index.js           # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ config-loader.js   # é…ç½®åŠ è½½å™¨
â”‚   â”œâ”€â”€ route-generator.js # è·¯ç”±ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ docs-generator.js  # æ–‡æ¡£ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ generate-docs.js   # æ–‡æ¡£ç”Ÿæˆè„šæœ¬
â”‚   â””â”€â”€ schema.js          # é…ç½®éªŒè¯
â”œâ”€â”€ data/                   # Mock æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ users.json
â”‚   â”œâ”€â”€ products.json
â”‚   â””â”€â”€ product-detail.json
â”œâ”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ docs/                   # ç”Ÿæˆçš„æ–‡æ¡£
â”œâ”€â”€ mock.config.json        # é…ç½®æ–‡ä»¶
â””â”€â”€ package.json
```

## ğŸ”§ API ç«¯ç‚¹

### å†…ç½®ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `{baseUrl}/docs` | GET | API æ–‡æ¡£ |

### ç¤ºä¾‹ç«¯ç‚¹

åŸºäºé»˜è®¤é…ç½®çš„å¯ç”¨ç«¯ç‚¹ï¼š

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° |
|------|------|------|
| `/api/users` | GET | è·å–ç”¨æˆ·åˆ—è¡¨ |
| `/api/users/:id` | GET | è·å–ç”¨æˆ·è¯¦æƒ… |
| `/api/users` | POST | åˆ›å»ºæ–°ç”¨æˆ· |
| `/api/products` | GET | è·å–äº§å“åˆ—è¡¨ |
| `/api/products/:id` | GET | è·å–äº§å“è¯¦æƒ… |
| `/api/search` | GET | æœç´¢æ¥å£ |
| `/api/error` | GET | é”™è¯¯å“åº”ç¤ºä¾‹ |

## ğŸŒŸ ä½¿ç”¨ç¤ºä¾‹

### è·å–ç”¨æˆ·åˆ—è¡¨

```bash
curl http://localhost:3001/api/users
```

å“åº”ï¼š
```json
[
  {
    "id": 1,
    "name": "å¼ ä¸‰",
    "email": "zhangsan@example.com",
    "age": 28,
    "city": "åŒ—äº¬"
  }
]
```

### è·å–ç”¨æˆ·è¯¦æƒ…

```bash
curl http://localhost:3001/api/users/123
```

å“åº”ï¼š
```json
{
  "id": "123",
  "name": "ç”¨æˆ·123",
  "email": "user123@example.com",
  "createdAt": "2024-01-01T00:00:00Z"
}
```

### åˆ›å»ºç”¨æˆ·

```bash
curl -X POST http://localhost:3001/api/users 
  -H "Content-Type: application/json" 
  -d '{"name":"æ–°ç”¨æˆ·","email":"new@example.com"}'
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. è¿è¡Œæµ‹è¯•
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [è·¯ç”±é»˜è®¤é…ç½®è¯´æ˜](./ROUTE_DEFAULTS.md)
- [æ–‡æ¡£ç”ŸæˆåŠŸèƒ½è¯´æ˜](./DOCS_GENERATION.md)
- [æµ‹è¯•è¯´æ˜](./tests/README.md)

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ [Issue](https://github.com/uphg/mock-server/issues)ã€‚"